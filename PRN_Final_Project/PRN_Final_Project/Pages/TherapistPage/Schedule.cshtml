@page
@model PRN_Final_Project.Pages.TherapistPage.ScheduleModel

@{
    ViewData["Title"] = "Therapist Schedule";
}

<h1>Therapist Schedule</h1>

<!-- Bootstrap Modal for Notifications -->
<div class="modal fade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="messageModalLabel">Notification</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="modalMessage"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary close-modal">Close</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            var message = "@TempData["Message"]";
            message = message.trim();

            if (message !== "" && message !== "undefined") {
                $('#modalMessage').text(message);
                $('#messageModal').modal('show');
            }

            $('.close-modal').click(function () {
                $('#messageModal').modal('hide');
            });

            $('.close').click(function () {
                $('#messageModal').modal('hide');
            });
        });
    </script>
}


<!-- Therapist Selection -->
<form method="get">
    <label for="therapist">Select Therapist:</label>
    <select name="SelectedTherapistId" id="therapist" class="form-select" onchange="this.form.submit()">
        <option value="">-- All Therapists --</option>
        @foreach (var therapist in Model.Therapists)
        {
            <option value="@therapist.theraID" selected="@(therapist.theraID == Model.SelectedTherapistId)">
                @therapist.fullName
            </option>
        }
    </select>
</form>

<!-- Display Schedule -->
@if (Model.Bookings.Any())
{
    <table class="table mt-3">
        <thead>
            <tr>
                <th>Appointment Date</th>
                <th>Time Slot</th>
                <th>Customer</th>
                <th>Status</th>
                <th>Total Price</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var booking in Model.Bookings)
            {
                <tr>
                    <td>@booking.appointmentDay.ToString("yyyy-MM-dd")</td>
                    <td>@booking.Slot.startTime</td>
                    <td>@booking.Customer.fullName</td>
                    <td>@booking.status</td>
                    <td>@booking.total</td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>No bookings found for this therapist.</p>
}
    
<button type="button" class="btn btn-secondary" onclick="goBack()">Back</button>

<script>
    function goBack() {
        window.history.back();
    }
</script>

<style>
    /* General Styling */
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f8f9fa;
        margin: 20px;
    }

    h1 {
        color: #343a40;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20px;
    }

    /* Therapist Selection Dropdown */
    label {
        font-weight: bold;
    }

    select {
        width: 100%;
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #ccc;
        margin-bottom: 20px;
    }

    /* Table Styling */
    table {
        width: 100%;
        background: #fff;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    th {
        background-color: #007bff;
        color: white;
        padding: 10px;
        text-align: center;
    }

    td {
        padding: 10px;
        text-align: center;
        border-bottom: 1px solid #ddd;
    }

    tr:hover {
        background-color: #f1f1f1;
    }

    /* Back Button */
    .btn-secondary {
        display: block;
        width: 150px;
        margin: 20px auto;
        font-size: 16px;
        font-weight: bold;
        border-radius: 5px;
        background: #6c757d;
        color: white;
        padding: 10px;
        text-align: center;
        text-decoration: none;
        transition: 0.3s;
    }

    .btn-secondary:hover {
        background: #5a6268;
    }

    /* Notification Modal */
    .modal-content {
        border-radius: 10px;
    }

    .modal-header {
        background-color: #007bff;
        color: white;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }

    .modal-body {
        font-size: 16px;
    }

    .modal-footer {
        display: flex;
        justify-content: center;
    }
</style>
